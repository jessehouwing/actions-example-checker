# Example action.schema.yml file
# This file demonstrates the advanced validation features available
# Place this file alongside your action.yml with the name action.schema.yml

# Define reusable custom types
types:
  # URL type validates http/https URLs
  url:
    type: string
    match: '^https?://.*'

  # Semantic version format (e.g., 1.2.3)
  semver:
    type: string
    match: "^\\d+\\.\\d+\\.\\d+$"

  # Email address validation
  email:
    type: string
    match: "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$"

  # Version pattern - supports basic semver and wildcards
  version:
    type: string
    match: '^(v?\d+(\.\d+)?(\.\d+)?|v?\d+\.\*|v?\d+\.\d+\.\*|latest)$'

  # Multiple versions with newline separator
  versions:
    type: string
    separators: newline
    match: '^(v?\d+(\.\d+)?(\.\d+)?|v?\d+\.\*|v?\d+\.\d+\.\*|latest)$'

# Validate inputs with explicit types
inputs:
  # Choice type - restricts to specific values (simple format)
  environment:
    type: choice
    options:
      - development
      - staging
      - production

  # Choice type with descriptions and alternatives
  # Allows primary values (a, d) or their alternatives (b, c, e, f) or simple option (g)
  # Alternatives support multiple formats:
  #   - YAML array: alternatives:\n    - b\n    - c
  #   - JSON/inline: alternatives: [b, c]
  #   - Single value: alternatives: b
  # Alternatives accept any scalar type (string, number, boolean, null) and convert to string:
  #   - alternatives: true → ['true']
  #   - alternatives: 123 → ['123']
  #   - alternatives: [true, 1, enabled] → ['true', '1', 'enabled']
  with-options:
    type: choice
    options:
      - value: a
        description: this does X
        alternatives:
          - b
          - c
      - value: d
        description: this does Y
        alternatives: [e, f] # Inline array syntax
      - g

  # Choice type with mixed simple and object options
  # This demonstrates that you can mix simple strings with object format
  log-format:
    type: choice
    options:
      - json
      - value: text
        description: Plain text format
        alternatives:
          - plain
          - simple
      - xml

  # Reference to custom type
  api-url:
    type: url

  # Another custom type reference (using semver type)
  release-version:
    type: semver

  # Type reference with added separators
  # References 'version' type (single) but adds separators to make it multi-value
  # Supports both comma-separated and newline-separated formats:
  # Comma-separated: 'v1.0.0,v2.0.0,v3.0.0'
  # Newline-separated: |
  #   v1.0.0
  #   v2.0.0
  ignore-versions:
    type: version
    separators: ['newline', ',']

  # Simple version reference (no separators, single value)
  target-version:
    type: version

  # Using versions type with predefined separators
  # Inherits 'newline' separator from the 'versions' type
  allowed-versions:
    type: versions

  # Override separators from referenced type
  # References 'versions' type but overrides its separator
  csv-versions:
    type: versions
    separators: ','

  # Boolean type - accepts truthy/falsy values
  # Truthy: true, yes, y, 1, on
  # Falsy: false, no, n, 0, off, (empty)
  dry-run:
    type: boolean

  # Number type
  timeout:
    type: number

  # String with inline pattern (not a custom type)
  log-level:
    type: string
    match: '^(debug|info|warn|error)$'

  # Email using custom type
  notification-email:
    type: email

  # Multi-value input with comma separator
  # Each tag must match the specified pattern
  # Note: Single separator can be specified as string or single-element array
  #   separators: ','  (quoted string)
  #   separators: [',']  (array with single element)
  tags:
    type: string
    separators: ','
    items:
      type: string
      match: '^[a-z0-9-]+$'

  # Multi-value input with multiple separators
  # Values can be separated by comma, semicolon, or pipe
  mixed-separators:
    type: string
    separators: [',', ';', '|']
    items:
      type: string

  # Multi-value input with newline separator (default when items is specified)
  # Each environment must be one of the specified options
  environments:
    type: string
    separators: newline
    items:
      type: choice
      options:
        - development
        - staging
        - production

  # Multi-value with numbers
  ports:
    type: string
    separators: ','
    items:
      type: number

  # Multi-value with combined newline and comma separators
  # Split by newline first, then by comma within each line
  combined-separators:
    type: string
    separators: ['newline', ',']
    items:
      type: string
      match: '^[a-z0-9-]+$'

  # Multi-value with any type (no validation)
  flexible-items:
    type: string
    separators: ','
    items:
      type: any

# Validate outputs (optional but recommended)
outputs:
  deployment-id:
    type: string

  deployment-url:
    type: url

  exit-code:
    type: number
